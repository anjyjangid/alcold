<div class="row">
	<div class="col-md-12">
		<div class="portlet light">
			<div class="portlet-title tabbable-line">
				<div class="caption caption-md">
					<i class="icon-globe theme-font hide"></i>
					<span class="caption-subject font-blue-madison bold uppercase">
					{{business._id?'Update':'Add'}} Business</span>
				</div>
				<div class="actions btn-set">					
					<button ng-disabled="loading" class="btn green" ng-click="store()"><i class="fa fa-check"></i>{{business._id?'Update':'Save'}}</button>
				</div>
			</div>
			<div class="portlet-body">
				<div class="form-horizontal">
					<div class="form-group" ng:class="{'has-error':errors['company_name'][0]}">
						<label class="col-md-2 control-label">Company Name: <span class="required">
						* </span>
						</label>
						<div class="col-md-10">
							<input type="text" class="form-control" ng-model="business.company_name" placeholder="">
							<span class="help-block" ng-bind="errors['company_name'][0]"></span>
						</div>

					</div>
					<div class="form-group" ng:class="{'has-error':errors['company_email'][0]}">
						<label class="col-md-2 control-label">Email Address: <span class="required">
						* </span>
						</label>
						<div class="col-md-10">
							<input type="text" class="form-control" ng-model="business.company_email" placeholder="">
							<span class="help-block" ng-bind="errors['company_email'][0]"></span>
						</div>
					</div>
					<tabset active="active">
						<tab>
							<tab-heading>Address</tab-heading>
							<div class="text-align-reverse margin-bottom-10">
								<a href="javascript:void(0)" ng-click="business.billing_address.push({})" class="btn yellow">
									<i class="fa fa-plus"></i> Add Address 
								</a>								
							</div>
							<div class="form-horizontal"  ng-repeat="detail in business.billing_address">
								<div class="row">
									<div class="form-group col-md-6" ng-class="{'has-error':errors['billing_address.'+$index+'.first_name'][0]}">
										<label class="col-md-3 control-label">Receiver's First Name: <span class="required">
										* </span>
										</label>
										<div class="col-md-9">
											<input type="text" class="form-control" ng-model="detail.first_name" placeholder="" name="first_name">
											<span class="help-block" ng-bind="errors['billing_address.'+$index+'.first_name'][0]"></span>
										</div>
									</div>
									<div class="form-group col-md-6" ng-class="{'has-error':errors['billing_address.'+$index+'.last_name'][0]}">
										<label class="col-md-3 control-label">Receiver's Last Name: <span class="required">
										* </span>
										</label>
										<div class="col-md-9">
											<input type="text" class="form-control" ng-model="detail.last_name" placeholder="" name="last_name">
											<span class="help-block" ng-bind="errors['billing_address.'+$index+'.last_name'][0]"></span>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="form-group col-md-6" ng-class="{'has-error':errors['billing_address.'+$index+'.receiver_contact'][0]}">
										<label class="col-md-3 control-label">Receiver's Contact Number: <span class="required">
										* </span>
										</label>
										<div class="col-md-9">
											<input type="text" class="form-control" ng-model="detail.receiver_contact" placeholder="" name="receiver_contact">
											<span class="help-block" ng-bind="errors['billing_address.'+$index+'.receiver_contact'][0]"></span>
										</div>
									</div>
									<div class="form-group col-md-6" ng-class="{'has-error':errors['billing_address.'+$index+'.instruction'][0]}">
										<label class="col-md-3 control-label">Instruction: <span class="required">
										* </span>
										</label>
										<div class="col-md-9">
											<input type="text" class="form-control" ng-model="detail.instruction" placeholder="" name="instruction">
											<span class="help-block" ng-bind="errors['billing_address.'+$index+'.instruction'][0]"></span>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="form-group col-md-6" ng-class="{'has-error':errors['billing_address.'+$index+'.address'][0]}">
										<label class="col-md-3 control-label">Location: <span class="required">
										* </span>
										</label>
										<div class="col-md-9">
											<input type="text" class="form-control" ng-model="detail.address" placeholder="" name="address">
											<span class="help-block" ng-bind="errors['billing_address.'+$index+'.address'][0]"></span>
										</div>
									</div>
									<div class="form-group col-md-6">
										<label class="col-md-3 control-label">Building name (optional):</label>
										<div class="col-md-9">
											<input type="text" class="form-control" ng-model="detail.address.building_name" placeholder="" name="building_name">		
										</div>
									</div>
								</div>
								<div class="row">
									<div class="form-group col-md-6">
										<label class="col-md-3 control-label">Floor: </label>
										<div class="col-md-9">
											<input type="text" class="form-control" ng-model="detail.address.floor" placeholder="" name="floor">
										</div>
									</div>
									<div class="form-group col-md-6">
										<label class="col-md-3 control-label">Unit: </label>
										<div class="col-md-9">
											<input type="text" class="form-control" ng-model="detail.address.unit" placeholder="" name="unit">
										</div>
									</div>
								</div>	
								<div class="text-align-reverse margin-bottom-10" ng-show="business.billing_address.length > 1">
									<a href="#" class="btn default btn-sm" ng-click="billingAddressRemove($index)">
										<i class="fa fa-times"></i> Remove </a>								
								</div>								
							</div>
						</tab>
						<tab>
							<tab-heading>Custom Discount</tab-heading>
							<div ng-show="errors.packageItems[0]" class="alert alert-danger fade in">
								<i class="fa-lg fa fa-warning"></i>
								{{ errors.packageItems[0] }}
							</div>

							<div class="pull-right" style="width: 100%;margin-bottom: 10px">
								<button type="button" class="btn default pull-right" ng-click="product.searchBox=''" data-target='#static' data-toggle="modal">
									<i class="fa fa-lg fa-plus"></i> Add Product
								</button>
							</div>
							<div class="row">
								<div ng-repeat-start="pcprod in business.products" ng:class="{'row':($index!=0 && $index%4==0)}" ng-init="pcprod.type=pcprod.type?pcprod.type:'%'"></div>
								<div class="col-md-3">

									<div class="thumbnail" style="padding: 9px;">

										<div class="text-center" style="width: 100%;height: 150px">
											<img style="max-height: 100%;margin:0 auto;" err-src="asset/i/defaultImage.png" ng-src="products/i/200/{{pcprod.imageFiles[0].source}}">
										</div>

										<div class="caption">
											<h5>{{ pcprod.name }}</h5>
											<div>
												<h5>Before Price : <b>${{pcprod.sprice}}</b></h5>
												<div class="input-group">
													<span class="input-group-btn">
														<button class="btn btn-{{pcprod.type=='$'?'primary':'default'}}"
														ng-click="pcprod.type='$'"
														>$</button>
														<button class="btn btn-{{pcprod.type!='$'?'primary':'default'}}"
														ng-click="pcprod.type='%'"
														>%</button>
													</span>
													<input min="1" type="number" placeholder="After Price" step="any" class="form-control" ng-model="pcprod.disc">
												</div>
												<!-- <span class="help-block" ng-bind="errors['packageItems.'+pckey+'.products.'+$index+'.cprice'][0]"></span> -->
												<p>After Price: <b>{{pcprod.sprice-((pcprod.type=='$'?pcprod.disc:(pcprod.disc*0.01*pcprod.sprice))||0) | currency}}</b></p>
												<a class="btn btn-sm btn-block btn-default" ng-click="removeItem($index)"><i class="fa fa-trash"></i> Remove</a>
											</div>
										</div>
									</div>

								</div>
								<div ng-repeat-end></div>
							</div>
							<div class="row">
								<div class="col-md-3" >
									
									<!-- <span class="help-block" ng-bind="errors['packageItems.'+pckey+'.products'][0]"></span> -->
								</div>
							</div>

						</tab>
					</tabset>
				</div>
			</div>
		</div>
	</div>
</div>

<div data-replace="true" tabindex="-1" class="modal fade modal-scroll" id="static" style="display: none;">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button aria-hidden="true" data-dismiss="modal" class="close" type="button"></button>
				<h4 class="modal-title">Select Package Items</h4>
			</div>
			<div class="modal-body">
				<div class="table-responsive">
					<input ng-model="product.searchBox" type="search" ng-class="{'spinner':searching}" class="form-control" placeholder="Search items to add in package">
					
					<table class="table table-striped table-hover" id="orderlist">
						<tbody>
							<tr ng-repeat="p in itemlist">
								<td width="100" valign="middle">
									<img width="100" err-src="asset/i/defaultImage.png" ng-src="products/i/200/{{p.imageFiles[0].source}}">
								</td>
								<td valign="middle">									
									{{p.name}}
									<div><b>${{p.sprice}}</b></div>
								</td>
								<td valign="middle">
									<a ng-if="!p.added" ng-click="addItem(p)" class="pull-right btn btn-default btn-xs green-stripe additem"><i class="fa fa-plus"></i> Add</a>
									<span ng-if="p.added" class="pull-right"><i class="fa fa-check"></i> Added</span>
								</td>
							</tr>							
						</tbody>
					</table>
				</div>
			</div>
			<div class="modal-footer">				
				<button class="btn green" data-dismiss="modal" type="button">Done</button>
			</div>
		</div>
	</div>
</div>
